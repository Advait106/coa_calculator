<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Arbitrary Precision Four-Function Calculator</title>

  <!-- Google Font -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#0f1114;
      --panel:#131417;
      --muted:#9aa3ae;
      --accent:#00e6b8;
      --button:#1b1e22;
      --button-hover:#222528;
      --glow:0 8px 22px rgba(0,230,184,0.12);
      --glass: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    }
    *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;}
    html,body{height:100%;background:linear-gradient(180deg,#0b0c0e 0%, #0f1114 100%);color:#e6eef3;margin:0;padding:0;display:flex;align-items:center;justify-content:center;}
    .container{
      width:100%;
      max-width:980px;
      margin:28px;
      display:grid;
      grid-template-columns: 1fr 420px;
      gap:28px;
      align-items:start;
    }

    /* Info panel */
    .info{
      background:var(--panel);
      border-radius:14px;
      padding:24px;
      box-shadow: var(--glow);
      min-height:420px;
    }
    .title{
      display:flex;align-items:center;gap:12px;margin-bottom:12px;
    }
    .logo{
      width:56px;height:56px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#6ff1d0);display:flex;align-items:center;justify-content:center;font-weight:700;color:#03221b;font-size:18px;
      box-shadow: 0 6px 20px rgba(0,230,184,0.12);
    }
    h1{margin:0;font-size:20px;}
    p.lead{margin:8px 0 18px;color:var(--muted);font-size:14px;line-height:1.45}
    .section{margin-top:10px;padding-top:12px;border-top:1px dashed rgba(255,255,255,0.03)}
    .section h3{margin:0 0 8px;font-size:15px}
    ul{margin:8px 0 0;padding-left:18px;color:var(--muted)}
    .team{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{background:rgba(255,255,255,0.02);padding:8px 10px;border-radius:8px;font-size:13px;color:#dfe9ec;border:1px solid rgba(255,255,255,0.02)}
    footer{margin-top:18px;color:var(--muted);font-size:13px}

    /* Calculator panel */
    .calculator{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:16px;
      padding:18px;
      box-shadow: 0 10px 40px rgba(2,6,10,0.6);
    }
    .display{
      background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(255,255,255,0.02));
      border-radius:12px;
      padding:14px 12px;
      color:#bfeee0;
      height:84px;
      display:flex;
      flex-direction:column;
      justify-content:center;
      align-items:flex-end;
      font-size:22px;
      letter-spacing:0.6px;
      box-shadow: inset 0 -3px 12px rgba(0,0,0,0.6);
      overflow:auto;
      word-break:break-all;
    }
    .small{
      color:var(--muted);
      font-size:12px;
    }

    .pad{
      margin-top:14px;
      display:grid;
      grid-template-columns: repeat(4,1fr);
      gap:12px;
    }

    button.key{
      background:var(--button);
      border:none;
      padding:16px 12px;
      border-radius:10px;
      font-size:18px;
      box-shadow: 0 8px 18px rgba(2,6,10,0.6), 0 2px 0 rgba(255,255,255,0.02) inset;
      cursor:pointer;
      transition: transform 80ms ease, box-shadow 120ms;
      color:#e6eef3;
      user-select:none;
    }
    button.key:active{ transform: translateY(2px) scale(0.997); }
    button.key:hover{ background:var(--button-hover); }

    button.op{
      background: linear-gradient(180deg,#07140f, #08372e);
      border:1px solid rgba(0,0,0,0.4);
      color:var(--accent);
      box-shadow: 0 8px 30px rgba(0,230,184,0.06);
      font-weight:600;
    }
    button.wide{ grid-column: span 2; }
    .accent{ color:var(--accent) }

    /* small screens adapt */
    @media (max-width:880px){
      .container{grid-template-columns: 1fr; padding:0 16px}
      .calculator{order:-1}
    }
    /* accessibility touches */
    .sr-only{position:absolute;left:-9999px}
  </style>
</head>
<body>

  <div class="container">
    <!-- Info panel -->
    <section class="info" aria-labelledby="project-title">
      <div class="title">
        <div class="logo">AP</div>
        <div>
          <h1 id="project-title">Arbitrary Precision Four-Function Calculator</h1>
          <div style="color:var(--muted);font-size:13px;margin-top:6px">A COA Final Project — precise math beyond hardware limits</div>
        </div>
      </div>

      <p class="lead">
        This project implements arithmetic without relying on language numeric types — instead it processes numbers as strings (digit arrays) to support arbitrary length and precision for Addition, Subtraction, Multiplication and Division.
      </p>

      <div class="section">
        <h3>What is arbitrary precision?</h3>
        <p style="color:var(--muted);font-size:14px;line-height:1.45">
          Arbitrary precision arithmetic represents numbers as sequences of digits rather than fixed-size integers or floats. It only depends on memory, not hardware word size, enabling correct results on extremely large or small numbers.
        </p>
      </div>

      <div class="section">
        <h3>Why is it important?</h3>
        <ul>
          <li>Handles numbers larger than built-in types (hundreds or thousands of digits).</li>
          <li>Removes rounding/overflow limits of native types.</li>
          <li>Crucial for cryptography, high-precision finance, scientific computing and theory projects.</li>
        </ul>
      </div>

      <div class="section">
        <h3>Core operations</h3>
        <ul>
          <li><strong>Addition</strong> — digit-by-digit with carry propagation.</li>
          <li><strong>Subtraction</strong> — borrow handling and sign management.</li>
          <li><strong>Multiplication</strong> — long multiplication (optimized algorithms could replace this).</li>
          <li><strong>Division</strong> — long division with configurable decimal precision.</li>
        </ul>

        <div class="team" style="margin-top:12px">
          <div class="chip">Shalin Mishra — RA2411033010011</div>
          <div class="chip">Snehil Sahay — RA2411033010015</div>
          <div class="chip">Advait Bhagwat — RA2411033010034</div>
        </div>

        <footer>Developed for COA Final Project — 2025</footer>
      </div>
    </section>

    <!-- Calculator panel -->
    <aside class="calculator" role="application" aria-label="Arbitrary precision calculator">
      <div class="display" id="display">
        <div class="small" id="subline">&nbsp;</div>
        <div id="mainline">0</div>
      </div>

      <div class="pad" aria-hidden="false">
        <button class="key" data-key="C" title="Clear" id="clear">C</button>
        <button class="key" data-key="±" id="neg">±</button>
        <button class="key" data-key="←" id="back">←</button>
        <button class="key op" data-op="÷" id="op-div">÷</button>

        <button class="key" data-key="7">7</button>
        <button class="key" data-key="8">8</button>
        <button class="key" data-key="9">9</button>
        <button class="key op" data-op="×" id="op-mul">×</button>

        <button class="key" data-key="4">4</button>
        <button class="key" data-key="5">5</button>
        <button class="key" data-key="6">6</button>
        <button class="key op" data-op="−" id="op-sub">−</button>

        <button class="key" data-key="1">1</button>
        <button class="key" data-key="2">2</button>
        <button class="key" data-key="3">3</button>
        <button class="key op" data-op="+" id="op-add">+</button>

        <button class="key wide" data-key="0">0</button>
        <button class="key" data-key=".">.</button>
        <button class="key op accent" data-op="=" id="equals">=</button>
      </div>
    </aside>
  </div>

<script>
/*
  Arbitrary-precision string-based arithmetic functions.
  All functions operate on decimal digits represented as strings.
  - No use of Number, parseInt for math beyond digit conversion.
  - Handles negative sign and decimal point by preprocessing.
*/

/* ---------- Utility helpers ---------- */

function trimLeadingZeros(s){
  // trim leading zeros but keep single '0'
  s = s.replace(/^0+/, '');
  return s === '' ? '0' : s;
}

function trimTrailingZeros(s){
  // for fractional parts: remove trailing zeros
  s = s.replace(/0+$/, '');
  return s === '' ? '0' : s;
}

function splitNumber(str){
  // returns { sign: '+/-', int: '...', frac: '...' } (no dots, int and frac non-empty)
  str = String(str).trim();
  if (str === '') return {sign:'+', int:'0', frac:'0'};

  let sign = '+';
  if (str[0] === '-' || str[0] === '+'){
    if (str[0] === '-') sign = '-';
    str = str.slice(1);
  }
  if (str === '') return {sign, int:'0', frac:'0'};

  if (str.indexOf('.') >= 0){
    let [i,f] = str.split('.');
    if (i === '') i = '0';
    if (f === '') f = '0';
    return {sign, int: i.replace(/^0+/, '') || '0', frac: f.replace(/0+$/, '') || '0'};
  } else {
    return {sign, int: str.replace(/^0+/, '') || '0', frac: '0'};
  }
}

function normalizeFractionLengths(aFrac, bFrac){
  // return [aFrac, bFrac] padded to same length to the right
  let la = aFrac.length, lb = bFrac.length;
  if (la < lb) aFrac = aFrac + '0'.repeat(lb - la);
  if (lb < la) bFrac = bFrac + '0'.repeat(la - lb);
  return [aFrac, bFrac];
}

function comparePos(a, b){
  // compare positive integer strings a and b, returns 1 if a>b, 0 if equal, -1 if a<b
  a = trimLeadingZeros(a); b = trimLeadingZeros(b);
  if (a.length > b.length) return 1;
  if (a.length < b.length) return -1;
  if (a > b) return 1;
  if (a < b) return -1;
  return 0;
}

/* ---------- Addition / Subtraction on positive integer strings ---------- */

function addPosIntegers(a, b){
  // a,b are integer-digit strings (no sign, no decimals)
  let res = [];
  let carry = 0;
  let i = a.length - 1, j = b.length - 1;
  while (i >= 0 || j >= 0 || carry){
    let da = i >= 0 ? (a.charCodeAt(i) - 48) : 0;
    let db = j >= 0 ? (b.charCodeAt(j) - 48) : 0;
    let s = da + db + carry;
    res.push(String(s % 10));
    carry = Math.floor(s / 10);
    i--; j--;
  }
  return res.reverse().join('');
}

function subPosIntegers(a, b){
  // returns a - b for a >= b, both positive integer strings
  let res = [];
  let borrow = 0;
  let i = a.length - 1, j = b.length - 1;
  while (i >= 0){
    let da = a.charCodeAt(i) - 48;
    let db = j >= 0 ? (b.charCodeAt(j) - 48) : 0;
    da -= borrow;
    if (da < db){
      da += 10;
      borrow = 1;
    } else {
      borrow = 0;
    }
    res.push(String(da - db));
    i--; j--;
  }
  // remove leading zeros
  return trimLeadingZeros(res.reverse().join(''));
}

/* ---------- Decimal addition / subtraction (handles fractional parts) ---------- */

function addStrings(x, y){
  // x and y are decimal strings possibly with sign. returns normalized result string.
  let A = splitNumber(x), B = splitNumber(y);
  // handle fraction lengths
  let [aFrac, bFrac] = normalizeFractionLengths(A.frac === '0' ? '' : A.frac, B.frac === '0' ? '' : B.frac);
  if (aFrac === '') aFrac = '0';
  if (bFrac === '') bFrac = '0';
  // make integer representations by concat int+frac
  let aIntFull = (A.int === '0' ? '0' : A.int) + (aFrac === '0' ? '' : aFrac);
  let bIntFull = (B.int === '0' ? '0' : B.int) + (bFrac === '0' ? '' : bFrac);

  // if either had no fractional part, ensure consistent length by padding right
  let fracLen = Math.max(A.frac === '0' ? 0 : A.frac.length, B.frac === '0' ? 0 : B.frac.length);
  // adjust full integer strings to have at least one digit
  aIntFull = aIntFull === '' ? '0' : aIntFull;
  bIntFull = bIntFull === '' ? '0' : bIntFull;

  // handle signs
  if (A.sign === B.sign){
    let sum = addPosIntegers(aIntFull, bIntFull);
    if (fracLen === 0) {
      return (A.sign==='-'?'-':'') + trimLeadingZeros(sum);
    } else {
      // put decimal point
      if (sum.length <= fracLen){
        sum = '0'.repeat(fracLen - sum.length + 1) + sum;
      }
      let intPart = sum.slice(0, sum.length - fracLen) || '0';
      let fracPart = sum.slice(sum.length - fracLen) || '0';
      fracPart = fracPart.replace(/0+$/,''); // remove trailing zeros
      let out = trimLeadingZeros(intPart) + (fracPart ? '.' + fracPart : '');
      return (A.sign==='-'?'-':'') + out;
    }
  } else {
    // subtraction: larger magnitude minus smaller magnitude, sign of larger
    let cmp = comparePos(aIntFull, bIntFull);
    if (cmp === 0) return '0';
    if (cmp > 0){
      let diff = subPosIntegers(aIntFull, bIntFull);
      if (fracLen === 0) return (A.sign==='-'?'-':'') + diff;
      if (diff.length <= fracLen) diff = '0'.repeat(fracLen - diff.length + 1) + diff;
      let intPart = diff.slice(0, diff.length - fracLen) || '0';
      let fracPart = diff.slice(diff.length - fracLen) || '0';
      fracPart = fracPart.replace(/0+$/,'');
      return (A.sign==='-'?'-':'') + trimLeadingZeros(intPart) + (fracPart ? '.' + fracPart : '');
    } else {
      // b larger
      let diff = subPosIntegers(bIntFull, aIntFull);
      if (fracLen === 0) return (B.sign==='-'?'-':'') + diff;
      if (diff.length <= fracLen) diff = '0'.repeat(fracLen - diff.length + 1) + diff;
      let intPart = diff.slice(0, diff.length - fracLen) || '0';
      let fracPart = diff.slice(diff.length - fracLen) || '0';
      fracPart = fracPart.replace(/0+$/,'');
      return (B.sign==='-'?'-':'') + trimLeadingZeros(intPart) + (fracPart ? '.' + fracPart : '');
    }
  }
}

function subStrings(x, y){
  // x - y
  // implement as x + (-y)
  if (String(y).startsWith('-')) y = y.slice(1);
  else y = '-' + y;
  return addStrings(x, y);
}

/* ---------- Multiplication ---------- */

function multiplyStrings(x, y){
  let A = splitNumber(x), B = splitNumber(y);
  let sign = (A.sign === B.sign) ? '' : '-';
  // handle fractions
  let aFracLen = (A.frac === '0' ? 0 : A.frac.length);
  let bFracLen = (B.frac === '0' ? 0 : B.frac.length);
  let totalFrac = aFracLen + bFracLen;

  let aDigits = A.int + (A.frac === '0' ? '' : A.frac);
  let bDigits = B.int + (B.frac === '0' ? '' : B.frac);

  aDigits = trimLeadingZeros(aDigits);
  bDigits = trimLeadingZeros(bDigits);

  if (aDigits === '0' || bDigits === '0') return '0';

  // classic O(n*m) multiplication
  let la = aDigits.length, lb = bDigits.length;
  let res = new Array(la + lb).fill(0);
  for (let i = la - 1; i >= 0; --i){
    let ai = aDigits.charCodeAt(i) - 48;
    let carry = 0;
    for (let j = lb - 1; j >= 0; --j){
      let bj = bDigits.charCodeAt(j) - 48;
      let pos = i + j + 1;
      let mul = ai * bj + res[pos] + carry;
      res[pos] = mul % 10;
      carry = Math.floor(mul / 10);
    }
    res[i] += carry;
  }
  // transform array to string
  let s = res.join('').replace(/^0+/, '');
  if (s === '') s = '0';
  // insert decimal if needed
  if (totalFrac === 0) return (sign === '-' ? '-' : '') + s;
  if (s.length <= totalFrac) s = '0'.repeat(totalFrac - s.length + 1) + s;
  let intPart = s.slice(0, s.length - totalFrac);
  let frac = s.slice(s.length - totalFrac).replace(/0+$/,'');
  let out = trimLeadingZeros(intPart) + (frac ? '.' + frac : '');
  return (sign === '-' ? '-' : '') + out;
}

/* ---------- Division (long division) ---------- */

function divideStrings(x, y, precision = 40){
  // Returns decimal string of x / y with up to `precision` fractional digits
  let A = splitNumber(x), B = splitNumber(y);
  // handle division by zero
  if (B.int === '0' && (B.frac === '0' || B.frac === '')) return "Error: Division by zero";

  // Convert both to integer strings by removing decimals
  let aDigits = A.int + (A.frac === '0' ? '' : A.frac);
  let bDigits = B.int + (B.frac === '0' ? '' : B.frac);
  let aFracLen = (A.frac === '0' ? 0 : A.frac.length);
  let bFracLen = (B.frac === '0' ? 0 : B.frac.length);

  // Shift to same scale: multiply numerator by 10^(precision + (bFracLen - aFracLen))
  // We'll implement long division by appending zeros to numerator as needed.
  let sign = (A.sign === B.sign) ? '' : '-';

  // Normalize integer strings
  aDigits = trimLeadingZeros(aDigits);
  bDigits = trimLeadingZeros(bDigits);
  if (bDigits === '0') return "Error: Division by zero";
  if (aDigits === '0') return '0';

  // We want integer division of (aDigits * 10^extra) / bDigits.
  // extra = precision + bFracLen - aFracLen (so resulting decimal has precision digits)
  let extra = precision + Math.max(0, bFracLen - aFracLen);
  let dividend = aDigits + '0'.repeat(extra); // append zeros
  // long division producing integer quotient, then insert decimal appropriately
  let quotient = '';
  let remainder = '';
  let pos = 0;
  while (pos < dividend.length){
    remainder += dividend[pos++];
    remainder = trimLeadingZeros(remainder);
    // find how many times bDigits goes into remainder
    if (comparePos(remainder, bDigits) < 0){
      quotient += '0';
      continue;
    } else {
      // naive count by subtraction with base 10 trial (could be optimized)
      let low = 0, high = 9, best = 0;
      // binary search for digit (0-9)
      while (low <= high){
        let mid = Math.floor((low + high) / 2);
        let prod = multiplyStrings(bDigits, String(mid));
        if (comparePos(prod, remainder) <= 0){ best = mid; low = mid + 1; }
        else high = mid - 1;
      }
      quotient += String(best);
      let prodBest = multiplyStrings(bDigits, String(best));
      // subtract
      remainder = subPosIntegers(remainder, prodBest);
    }
  }
  quotient = trimLeadingZeros(quotient);
  if (quotient === '') quotient = '0';

  // Now we must place decimal point: integer part length = quotient.length - precision
  if (quotient.length <= precision){
    // integer part is 0
    quotient = '0'.repeat(precision - quotient.length + 1) + quotient;
  }
  let intLen = quotient.length - precision;
  let intPart = quotient.slice(0, intLen) || '0';
  let fracPart = quotient.slice(intLen) || '';
  // remove trailing zeros from frac but preserve at least one if all zero and precision requested? We'll trim.
  fracPart = fracPart.replace(/0+$/, '');
  let result = trimLeadingZeros(intPart) + (fracPart ? '.' + fracPart : '');
  // apply sign
  if (result === '0') return '0';
  return (sign === '-' ? '-' : '') + result;
}

/* ---------- High-level compute wrapper ---------- */

function compute(op, a, b){
  a = String(a).trim();
  b = String(b).trim();
  // sanitize simple inputs like empty to zero
  if (a === '') a = '0';
  if (b === '') b = '0';

  if (op === '+') return addStrings(a, b);
  if (op === '-') return subStrings(a, b);
  if (op === '*') return multiplyStrings(a, b);
  if (op === '/') return divideStrings(a, b, 60); // high precision for division
  return "Err";
}

/* ---------- UI logic for the calculator ---------- */

let state = {
  a: '0',          // first operand (string)
  b: null,         // second operand (string) when operator selected
  op: null,        // '+', '-', '*', '/'
  typingB: false,  // whether we are typing second operand
  displayMain: '0',
  displaySub: ''
};

const displayMain = document.getElementById('mainline');
const displaySub = document.getElementById('subline');

function refreshDisplay(){
  if (!state.typingB){
    displayMain.textContent = state.a;
    displaySub.textContent = state.op ? (state.a + ' ' + state.op) : '';
  } else {
    displayMain.textContent = state.b === null ? '0' : state.b;
    displaySub.textContent = state.a + ' ' + state.op;
  }
}

function clearAll(){
  state.a = '0'; state.b = null; state.op = null; state.typingB = false;
  refreshDisplay();
}

function backspace(){
  if (!state.typingB){
    if (state.a.length <= 1) state.a = '0';
    else state.a = state.a.slice(0,-1);
  } else {
    if (!state.b || state.b.length <= 1) state.b = '0';
    else state.b = state.b.slice(0,-1);
  }
  refreshDisplay();
}

function appendDigit(d){
  if (!state.typingB){
    if (state.a === '0' && d !== '.') state.a = d;
    else if (d === '.' && state.a.indexOf('.') !== -1) return;
    else state.a += d;
  } else {
    if (state.b === null || state.b === '0' && d !== '.') state.b = d;
    else if (d === '.' && state.b.indexOf('.') !== -1) return;
    else state.b += d;
  }
  refreshDisplay();
}

function toggleSign(){
  if (!state.typingB){
    if (state.a === '0') return;
    state.a = state.a[0] === '-' ? state.a.slice(1) : '-' + state.a;
  } else {
    if (!state.b || state.b === '0') return;
    state.b = state.b[0] === '-' ? state.b.slice(1) : '-' + state.b;
  }
  refreshDisplay();
}

function setOperator(op){
  if (state.op && state.typingB && state.b !== null){
    // compute intermediate result to chain operations
    let res = compute(state.op, state.a, state.b);
    state.a = res;
    state.b = null;
    state.op = op;
    state.typingB = true;
  } else {
    state.op = op;
    state.typingB = true;
    state.b = null;
  }
  refreshDisplay();
}

function evaluate(){
  if (!state.op || state.b === null) return;
  let res = compute(state.op, state.a, state.b);
  state.a = res;
  state.b = null;
  state.op = null;
  state.typingB = false;
  refreshDisplay();
}

/* Hook up buttons */

document.querySelectorAll('button.key').forEach(btn => {
  btn.addEventListener('click', (e) => {
    let k = btn.getAttribute('data-key');
    let op = btn.getAttribute('data-op');
    if (k === 'C'){ clearAll(); return; }
    if (k === '←'){ backspace(); return; }
    if (k === '±'){ toggleSign(); return; }
    if (op){
      if (op === '='){ evaluate(); return; }
      // map symbols to internal operators
      let map = {'+':'+','−':'-','×':'*','÷':'/'};
      setOperator(map[op] || op);
      return;
    }
    // digit or dot
    appendDigit(k);
  });
});

/* Keyboard support */
window.addEventListener('keydown', function(ev){
  let k = ev.key;
  if (k >= '0' && k <= '9') appendDigit(k);
  else if (k === '.' || k === ',') appendDigit('.');
  else if (k === 'Enter' || k === '=') evaluate();
  else if (k === 'Backspace') backspace();
  else if (k === 'Escape') clearAll();
  else if (k === '+' || k === '-') setOperator(k);
  else if (k === '*' || k === 'x' || k === 'X') setOperator('*');
  else if (k === '/') setOperator('/');
});

/* init */
clearAll();

</script>
</body>
</html>
